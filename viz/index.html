<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
		<title>D3: A simple packed Bubble Chart</title>
		<style type="text/css">
			.tooltip{
				position: fixed;
				opacity:0;
				width: 200px;
				height: auto;
				background: none repeat scroll 0 0 #D3D3D3;
				border: 1px solid #000000;
				border-radius: 2px;
				padding: 4px;
				text-align: center;
				font-size:1em;
				font-family:sans-serif;
				right:10px;
				top:50px;
				word-wrap: break-word;
			}
			.left {
				width:70%;
				float:left;
			}

			#right {
				width:30%;
				float:right;
			}

			.viz {
				border-bottom: 2px black solid;
			}
		</style>
		<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
	<div>
		<form id="add" method="post">
			<fieldset>
				<!-- <legend><span class="number"></span> New Country </legend> -->
				<label>Keyword:</label>
				<select name="continent" required>
					<option disabled selected value> -- Select an Keyword -- </option>
					<option value="Asia">Asia</option>
					<option value="North America">North America</option>
					<option value="South America">South America</option>
					<option value="Europe">Europe</option>
					<option value="Africa">Africa</option>
					<option value="Australia">Australia</option>
					<option value="Antarctica">Antarctica</option>
				</select>
			</fieldset>
			<!-- <input type="submit" name="add" value="Visualize" /> -->
			<!-- <a href="javascript: submitform()">Submit</a> -->
			<input type="button" name="submit_id" id="btn_id" value="Submit by Id" onclick="submit_by_id()"/>
		</form>
	</div>
	<div class="left">
		<div class="viz" id="div1">
		</div>
		<div class="viz" id="div2">
		</div>
		<div id="div3">
		</div>
	</div>
	<div id="right">
	</div>
	<script type="text/javascript">
	var root;
	// Submit form with id function.
	function submit_by_id() {
		console.log(root);
		root = [
			{
					"children": [
						{"Name":"Olives","Count":4319,
						"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
							{"Name":"Tea","Count":4159,
						"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
							{"Name":"Mashed Potatoes","Count":2583,
						"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
							{"Name":"Boiled Potatoes","Count":2074,
						"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
							{"Name":"Milk","Count":1894,
						"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},]
			},
			{
					"children": [
						{"Name":"Chicken Salad","Count":1809},
						{"Name":"Vanilla Ice Cream","Count":1713},
						{"Name":"Cocoa","Count":1636},
						{"Name":"Lettuce Salad","Count":1566},
						{"Name":"Lobster Salad","Count":1511},
						{"Name":"Chocolate","Count":1489},
						]
			},
			{
				"children": [
					{"Name":"Apple Pie","Count":1487},
					{"Name":"Orange Juice","Count":1423},
					{"Name":"American Cheese","Count":1372},
					{"Name":"Green Peas","Count":1341},
					{"Name":"Assorted Cakes","Count":1331},
					{"Name":"French Fried Potatoes","Count":1328},
					{"Name":"Potato Salad","Count":1306},
					{"Name":"Baked Potatoes","Count":1293},
					{"Name":"Roquefort","Count":1273},
					{"Name":"Stewed Prunes","Count":1268}
					]
			}
		];
		console.log(root);


		if(root != undefined){
			console.log(root);
			var diameter = 600;
			var color = d3.scaleOrdinal(d3.schemeCategory20);
			// d3.selectAll("svg").exit().remove();
			d3.selectAll("svg").remove();
			var svg = d3.select("#div1")
					.append("svg")
					.attr("width", diameter)
					.attr("height", diameter)
					.attr("class", "bubble");
			update(root[0],svg);
			var svg1 = d3.select("#div2")
					.append("svg")
					.attr("width", diameter)
					.attr("height", diameter)
					.attr("class", "bubble");
			update(root[1],svg1);
			var svg2 = d3.select("#div3")
					.append("svg")
					.attr("width", diameter)
					.attr("height", diameter)
					.attr("class", "bubble");
			update(root[2],svg2);


		}
	}

			// function submitform()
			// {
		    // document.forms["add"].submit();
				// if(document.add.onsubmit())
				// {
			    // document.myform.submit();

				// root = [
				// 	{
	      //       "children": [
				// 				{"Name":"Olives","Count":4319,
				// 				"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
	      //           {"Name":"Tea","Count":4159,
				// 				"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
	      //           {"Name":"Mashed Potatoes","Count":2583,
				// 				"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
	      //           {"Name":"Boiled Potatoes","Count":2074,
				// 				"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},
	      //           {"Name":"Milk","Count":1894,
				// 				"Desc":"Memes emememsmsdlfkjaslkdfjlakjglksjfdlkaj slfkdjalksdfjklajsdakjksd"},]
	      //   },
				// 	{
	      //       "children": [
				// 				{"Name":"Chicken Salad","Count":1809},
				// 				{"Name":"Vanilla Ice Cream","Count":1713},
				// 				{"Name":"Cocoa","Count":1636},
				// 				{"Name":"Lettuce Salad","Count":1566},
				// 				{"Name":"Lobster Salad","Count":1511},
				// 				{"Name":"Chocolate","Count":1489},
				// 				]
	      //   },
				// 	{
				// 		"children": [
				// 			{"Name":"Apple Pie","Count":1487},
				// 			{"Name":"Orange Juice","Count":1423},
				// 			{"Name":"American Cheese","Count":1372},
				// 			{"Name":"Green Peas","Count":1341},
				// 			{"Name":"Assorted Cakes","Count":1331},
				// 			{"Name":"French Fried Potatoes","Count":1328},
				// 			{"Name":"Potato Salad","Count":1306},
				// 			{"Name":"Baked Potatoes","Count":1293},
				// 			{"Name":"Roquefort","Count":1273},
				// 			{"Name":"Stewed Prunes","Count":1268}
				// 			]
				// 	}
				// ];
		// 	}
		// }


		function update(source,s) {
			console.log("src: " + source);
			var diameter = 600;
			var color = d3.scaleOrdinal(d3.schemeCategory20);
			var bubble = d3.pack(source)
					.size([diameter, diameter])
					.padding(1.5);

			var nodes = d3.hierarchy(source)
					.sum(function(d) { return d.Count; });

			console.log(nodes);
			var div = d3.select("#right").append("div")
						.attr("class", "tooltip")
						.style("opacity", 0);

			var node = s.selectAll(".node")
					.data(bubble(nodes).descendants())
					.enter()
					.filter(function(d){
							return  !d.children
					})
					.append("g")
					.attr("class", "node")
					.attr("transform", function(d) {
							return "translate(" + d.x + "," + d.y + ")";
					})
					.on('click',function(d){
								div.transition().duration(200)
									//.style('left',d3.event.pageX - 20 + "px")
									//.style('top',d3.event.pageY + "px")
									.style('opacity','0.9')
									.style('display','inline-block')
								div.html(d.data.Desc);
							})
				/*.on("mouseout", function(d){
					div.transition().duration(200)
						.style('opacity','0');
					});*/

			node.append("title")
					.text(function(d) {
							return d.Name + ": " + d.Rank;
					});

			node.append("circle")
					.attr("r", function(d) {
							return d.r;
					})
					.style("fill", function(d,i) {
							return color(i);
					});

			node.append("text")
					.attr("dy", ".2em")
					.style("text-anchor", "middle")
					.text(function(d) {
							return d.data.Name.substring(0, d.r / 3);
					})
					.attr("font-family", "sans-serif")
					.attr("font-size", function(d){
							return d.r/5;
					})
					.attr("fill", "white");

			node.append("text")
					.attr("dy", "1.3em")
					.style("text-anchor", "middle")
					.text(function(d) {
							return d.data.Count;
					})
					.attr("font-family",  "Gill Sans", "Gill Sans MT")
					.attr("font-size", function(d){
							return d.r/5;
					})
					.attr("fill", "white");

			d3.select(self.frameElement)
					.style("height", diameter + "px");
		}



	</script>


</body>
</html>
